const axios = require('axios');
const fs = require('fs');

const appKey = 'tEiRteq9K69x8eOSBcOJb3FWVFkzNRiJ3OxUBB1m'; // Tmap ì•±í‚¤ ê·¸ëŒ€ë¡œ

const names = [
  "ê¹€í¬ì†Œë°©ì„œ",
  // "ì¤‘ì•™119ì•ˆì „ì„¼í„° (ê¹€í¬)",
  "ì–‘ì´Œ119ì•ˆì „ì„¼í„°",
  "ë§ˆì‚°119ì•ˆì „ì„¼í„°", "ëŒ€ê³¶119ì•ˆì „ì„¼í„°", "í†µì§„119ì•ˆì „ì„¼í„°",
  "ê³ ì´Œ119ì•ˆì „ì„¼í„°", "í•˜ì„±119ì•ˆì „ì„¼í„°", "ê´´ì•ˆ119ì•ˆì „ì„¼í„°",
  "ë²”ë°•119ì•ˆì „ì„¼í„°", "ì˜¤ì •119ì•ˆì „ì„¼í„°", "ì›ì¢…119ì•ˆì „ì„¼í„°",
  "ì—¬ì›”119ì•ˆì „ì„¼í„°", "ë¶€ì²œì†Œë°©ì„œ",
  // "ì¤‘ì•™119ì•ˆì „ì„¼í„° (ë¶€ì²œ)",
  "ì¤‘ë™119ì•ˆì „ì„¼í„°", "ìƒë™119ì•ˆì „ì„¼í„°", "ì„œë¶€119ì•ˆì „ì„¼í„°",
  "ì‹ ìƒ119ì•ˆì „ì„¼í„°", "ì‹œí¥ì†Œë°©ì„œ", "ì‹œí¥119ì•ˆì „ì„¼í„°",
  "ì€í–‰119ì•ˆì „ì„¼í„°", "ì •ì™•119ì•ˆì „ì„¼í„°", "ì—°ì„±119ì•ˆì „ì„¼í„°",
  "ëª©ê°119ì•ˆì „ì„¼í„°", "ë°°ê³§119ì•ˆì „ì„¼í„°", "ì‚¬ë™119ì•ˆì „ì„¼í„°",
  "ë°˜ì›”119ì•ˆì „ì„¼í„°", "ìƒë¡ìˆ˜119ì•ˆì „ì„¼í„°", "ì›”í”¼119ì•ˆì „ì„¼í„°",
  "êµ°ì119ì•ˆì „ì„¼í„°", "ëŒ€ë¶€119ì•ˆì „ì„¼í„°", "ì‹ ê¸¸119ì•ˆì „ì„¼í„°",
  "ì•ˆì‚°ì†Œë°©ì„œ", "ì¸í•˜ëŒ€í•™êµì˜ê³¼ëŒ€í•™ë¶€ì†ë³‘ì›", "ê°€í†¨ë¦­ê´€ë™ëŒ€í•™êµì¸ì²œì„±ëª¨ë³‘ì›",
  "ê°€í†¨ë¦­ê´€ë™ëŒ€í•™êµêµ­ì œì„±ëª¨ë³‘ì›", "ê²€ë‹¨íƒ‘ë³‘ì›", "ì¸ì²œì„¸ì¢…ë³‘ì›",
  "ë‚˜ì‚¬ë ›êµ­ì œë³‘ì›", "ë‚˜ì€ë³‘ì›", "ì¸ì²œì‚¬ë‘ë³‘ì›", "ë¶€í‰ì„¸ë¦¼ë³‘ì›",
  "í•œë¦¼ë³‘ì›", "ë¹„ì—ìŠ¤ì¢…í•©ë³‘ì›", "ì˜¨ëˆ„ë¦¬ë³‘ì›", "ë‰´ ì„±ë¯¼ë³‘ì›",
  "ì¸ì²œê´‘ì—­ì‹œì˜ë£Œì›", "ì¸ì²œê¸°ë…ë³‘ì›", "í˜„ëŒ€ìœ ë¹„ìŠ¤ë³‘ì›", "ë°±ë ¹ë³‘ì›",
  "í˜ì°¬ì¢…í•©ë³‘ì›", "ì¸ì²œì ì‹­ìë³‘ì›", "ì¸ì²œë°±ë³‘ì›", "ê°€í†¨ë¦­ëŒ€ë¶€ì²œì„±ëª¨ë³‘ì›",
  "ë‹¤ë‹ˆì—˜ì¢…í•©ë³‘ì›", "ë¶€ì²œì„¸ì¢…ë³‘ì›", "ìˆœì²œí–¥ëŒ€ë¶€ì†ë¶€ì²œë³‘ì›",
  "ê´‘ëª…ì„±ì• ë³‘ì›", "ì¤‘ì•™ëŒ€ê´‘ëª…ë³‘ì›", "ê³ ë ¤ëŒ€ì•ˆì‚°ë³‘ì›",
  "ê·¼ë¡œë³µì§€ê³µë‹¨ì•ˆì‚°ë³‘ì›", "í•œë„ë³‘ì›", "ì‚¬ë‘ì˜ë³‘ì›", "ë‹¨ì›ë³‘ì›",
  "ì„¼íŠ¸ëŸ´ë³‘ì›", "ì‹œí™”ë³‘ì›", "ì‹ ì²œì—°í•©ë³‘ì›", "ê¹€í¬ìš°ë¦¬ë³‘ì›", "ë‰´ê³ ë ¤ë³‘ì›"
];

const delay = ms => new Promise(resolve => setTimeout(resolve, ms));

(async () => {
  const results = [];

  for (let name of names) {
    try {
      const { data } = await axios.get('https://apis.openapi.sk.com/tmap/geo/fullAddrGeo', {
        params: {
          version: 1,
          addr: name,
          appKey
        }
      });

      const info = data.coordinateInfo.coordinate[0];

      results.push({
        name,
        x: parseFloat(info.newLon),
        y: parseFloat(info.newLat),
        type: name.includes("ë³‘ì›") ? "ë³‘ì›" : "ì†Œë°©ì„œ",
        address: info.fullAddress,
        tel: ""
      });

      console.log(`âœ… ${name} â†’ (${info.newLat}, ${info.newLon})`);
      await delay(1000); // 1ì´ˆ ëŒ€ê¸°
    } catch (err) {
      console.error(`âŒ ${name} ì‹¤íŒ¨:`, err.response?.data?.resultMsg || err.message);
    }
  }

  fs.writeFileSync('data/traumaPoints.json', JSON.stringify(results, null, 2), 'utf8');
  console.log("ğŸ‰ ì €ì¥ ì™„ë£Œ â†’ data/traumaPoints.json");
})();
